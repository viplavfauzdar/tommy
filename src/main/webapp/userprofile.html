<!DOCTYPE html>
<html>
    <head>
        <title>Finance Georgia | User Profile</title>
        <meta charset='utf-8'>
        <meta content='Description' name='description'>
        <meta content='1 day' name='revisit-after'>
        <meta content='width=device-width, initial-scale=1' name='viewport'>
        <link href="stylesheets/font-awesome.min.css" media="screen" rel="stylesheet" type="text/css" />
        <link href="stylesheets/bootstrap.min.css" media="screen" rel="stylesheet" type="text/css" />
        <link href='//fonts.googleapis.com/css?family=Lato:100,300,400,300italic,400italic,700,700italic,900' rel='stylesheet'>
        <link href='//fonts.googleapis.com/css?family=Raleway:400,600,700' rel='stylesheet'>
        <link href="stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
        <style>
            a:link  {
                text-decoration: none;
            }
        </style>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    </head>
    <body>

        <div class='wrapper'>

            <!-- Topbar -->            
            <div class='top' data-spy='affix' id='navbar'></div>

            <section class='jumbotronsmall' id='home'>
                <div class='flexslider' id='flexslider1'>
                    <ul class='slides'>

                        <li class='slide light'>
                            <img alt='' class='fs fo' src='Assets/Slider/header-04.jpg'>

                        </li>
                    </ul>
                </div>
            </section>            

            <!-- Business Profile -->

            <section class='grey' id='team'>
                <div class='row-fluid'>
                    <div class='col-md-12 text-left padding-20'>
                        <h2 id='userName'></h2>
                        <!--                        <h4>Slogan or quick overview of company</h4>-->
                        <!--                        <p id='summary1'></p>-->
                        <h4 id='address'></h4>
                    </div>
                    <div class='col-md-8 col-xs-8'>
                        <div class='member'>
                            <div class='img'>
                                <div class='social'>
                                    <div class='icons'>
                                        <img src="Assets/Finance-Georgia-Logo.png" alt=""/>
                                    </div>
                                </div>
                                <!-- company slide show  - class fo is what dims the image. don't need it here -->
                                <section class='jumbotron minfixed' id="busSlides">
                                    <div class='flexslider' id='flexslider2'>
                                        <ul class='slides'>
                                            <li class='slide dark'>
                                                <img style='width:663px;height:400px' id='profilePic'>
                                            </li>
<!--                                            <li class='slide dark'>
                                                <img style='width:663px;height:400px' id='businessPic2'>
                                            </li>-->
                                        </ul>
                                    </div>
                                </section>
                            </div>
                            
<!--      Need to look at this                      <div class='img'>
                                <div class='social'>
                                    <div class='icons'>
                                        <img src="Assets/Finance-Georgia-Logo.png" alt=""/>
                                    </div>

                                </div>
                                <img style='width:320px;height:250px' id="profilePic">
                            </div>-->

                            <script>
                                //This seems to work  - NOT SURE IF THIS IS NEEDDED.
                                // this was prolly because of extra li the flex slider inserts if the jq at the bottom is used
                                //potential sol to move getJSON to the top
                                var hash = window.location.hash;
                                var uid = hash.substring(hash.indexOf('/') + 1, hash.length);
//                                var busIdd = busId.substring(0,busId.indexOf('#'));
//                                console.log("Bus ID: " + busIdd);
//                                var uid = busId.substring(busId.indexOf('#') + 1, busId.length);
//                                console.log("User ID: " + uid);
                                document.getElementById("profilePic").src = "/Uploader?action=stream&folder=" + uid + "&filename=profilePic.jpg&t=" + Math.random();
//                                document.getElementById("businessPic2").src = "/Uploader?action=stream&folder=" + uid + "&filename=businessPic2.jpg&t=" + Math.random();
                            </script>

                        </div>
                        <h2>About Me</h2>
<!--                        <h4>User Summary</h4>-->
                        <p id='aboutMe'></p>
<!--                        <h4>Description</h4>
                        <p id='description'></p>-->

                        <!-- 16:9 aspect ratio -->
<!--                        <div class="embed-responsive embed-responsive-16by9">
                            <iframe class="embed-responsive-item" src="" id="businessVideo"></iframe>
                        </div>-->

                        <!-- social -->
                        <a class='icon fa fa-globe' id='lnkWs' target='_blank' href='#'></a>
                        <a class='icon fa fa-facebook-square' id='lnkFb' target='_blank' href='#'></a>
                        <a class='icon fa fa-twitter-square' id='lnkTw' target='_blank' href='#'></a>
                        <a class='icon fa fa-google-plus-square' id='lnkGp' target='_blank' href='#'></a>
                        <a class='icon fa fa-linkedin-square' id='lnkLk' target='_blank' href='#'></a>
                    </div>
<!--                    <div class='col-md-4 col-xs-6'>
                        <div class='member'>
                            <div class='img'>
                                <div class='social'>
                                    <div class='icons'>
                                        <img src="Assets/Finance-Georgia-Logo.png" alt=""/>
                                    </div>

                                </div>
                                <img style='width:320px;height:250px' id="businessLogo1">
                            </div>
                            <div class='info'>
                                <h4 id='businessName1'></h4>
                                <h5 id='address1'></h5>
                                <h6><span class="target">TARGET: <b id='targetAmount'></b></span><span class="pledged"> PLEDGED: <b id='amountInvested'></b></span></h6>
                                <div class='progress'>
                                    <div aria-valuemax='100' aria-valuemin='0'  class='progress-bar progress-bar-success' role='progressbar'>  aria-valuenow='50' cause to default to 50%
                                        <span class='sr-only'>
                                            40% Funded
                                        </span>
                                    </div>
                                </div>
                                <p id='summary1'></p>
                                <a class='btn btn-default invest' id="ivstComp" href='#about' style="width: 250px">Invest in this company</a>
                                <a class='btn btn-default' href='#' id="execSumm" target="_blank" style="width: 250px">Executive Summary</a>
                                <a class='btn btn-default' href='#' id="businessPlan" target="_blank" style="width: 250px">Business Plan</a>
                                <a class='btn btn-default' href='#' id="financials" target="_blank" style="width: 250px">Financials</a>
                                <a class='icon fa fa-globe' id='lnkWs' target='_blank' href='#'></a>
                                <a class='icon fa fa-facebook-square' id='lnkFb' target='_blank' href='#'></a>
                                <a class='icon fa fa-twitter-square' id='lnkTw' target='_blank' href='#'></a>
                                <a class='icon fa fa-google-plus-square' id='lnkGp' target='_blank' href='#'></a>
                                <a class='icon fa fa-linkedin-square' id='lnkLk' target='_blank' href='#'></a>
                            </div>
                        </div>
                    </div>-->


                </div>

            </section>

            <!-- Banner -->
            <div id='banner'></div>

            <!-- Footer -->
            <div id='footer'></div>

            <!-- Copyright -->
            <div id='copyright'></div>

        </div>
        <!-- jQuery -->    
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <!-- JQuery validation -->
        <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.13.1/jquery.validate.min.js'></script>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.13.1/additional-methods.min.js'></script>
        <!-- Easing -->
        <script src="javascripts/jquery.easing.1.3.js" type="text/javascript"></script>
        <!-- Flexslider -->
        <script src="javascripts/jquery.flexslider.js" type="text/javascript"></script>
        <!-- Bootstrap JS -->
        <script src="javascripts/bootstrap.min.js" type="text/javascript"></script>
        <!--         Waypoints -->
        <script src="javascripts/waypoints.min.js" type="text/javascript"></script>
        <!--         Contactform 
                <script src="javascripts/validation.js" type="text/javascript"></script>        -->
        <!-- Functions -->
        <script src="javascripts/functions.js" type="text/javascript"></script>
        <!-- Autonumeric -->
        <script src="javascripts/autoNumeric.js" type="text/javascript"></script> 
        <!-- JQuery.Number -->
        <script src="javascripts/jquery.number.min.js" type="text/javascript"></script>
        <!-- FG -->
        <script src="javascripts/FG.js" type="text/javascript"></script>

        <script>

            //** incase of missing pics or pics that didn't load
            $("img").error(function () {
                $(this).unbind("error").attr("src", "img/placeholder.jpg");
            });

            $("a").error(function () {
                $(this).unbind("error").attr("href", "img/placeholder.jpg");
            });

//            var hash = window.location.hash;
//            console.log(hash);
//            var usrId = hash.substring(hash.indexOf('/') + 1, hash.length);

            loaderOn();
            $.getJSON("/rs/public/user/" + uid, function (item) {
                loaderOff();
                console.log(item.userId);
                //console.log(JSON.stringify(item));
                $('#address').html(item.address + ', ' + item.city + ', ' + item.state + ', ' + item.zip);
                //$('#address1').html(item.address + ', ' + item.city + ', ' + item.state + ', ' + item.zip);
                $('#userName').html(item.firstName + ' ' + item.mi + ' ' + item.lastName);
                //$('#businessName1').html(item.businessName);
                $('#aboutMe').html(item.aboutMe);
//                $('#summary1').html(item.summary.replace(/(?:\r\n|\r|\n)/g, '<br />'));
//                $('#description').html(item.description.replace(/(?:\r\n|\r|\n)/g, '<br />'));
//                $('#targetAmount').autoNumeric('init', {aSign: '$', mDec: 0});
//                $('#targetAmount').autoNumeric('set', item.targetAmount);
//                $('#amountInvested').autoNumeric('init', {aSign: '$', mDec: 0});
//                $('#amountInvested').autoNumeric('set', item.amountInvested);
//                $('.progress-bar').css('width', (100 * item.amountInvested / item.targetAmount) + '%');

                //if(uid === null || uid === '') 
                //uid = item.userId;

                //set all images & documents
                //$('#businessLogo').attr("src", "/Uploader?action=stream&folder=" + uid + "&filename=businessLogo.jpg&t=" + Math.random());
                $('#profilePic').attr("src", "/Uploader?action=stream&folder=" + uid + "&filename=profilePic.jpg&t=" + Math.random());
//                $('#businessPic1').attr("src", "/Uploader?action=stream&folder=" + uid + "&filename=businessPic1.jpg&t=" + Math.random());
//                $('#businessPic2').attr("src", "/Uploader?action=stream&folder=" + uid + "&filename=businessPic2.jpg&t=" + Math.random());
//                $('#execSumm').attr("href", "/Uploader?action=stream&folder=" + uid + "&filename=execSumm.pdf&t=" + Math.random());
//                $('#businessPlan').attr("href", "/Uploader?action=stream&folder=" + uid + "&filename=businessPlan.pdf&t=" + Math.random());
//                $('#financials').attr("href", "/Uploader?action=stream&folder=" + uid + "&filename=financials.pdf&t=" + Math.random());

                //below doesn't work either - doesn't even load images
//                slider = "<div class='flexslider' id='flexslider2'>" + 
//                    "<ul class='slides'>" +
//                        "<li class='slide dark'>"
//                            "<img style='width:663px;height:400px' class='fo' id='businessPic1' src='/Uploader?action=stream&folder=" + uid + "&filename=businessPic1.jpg'>" +
//                        "</li>" +
//                        "<li class='slide dark'>" +
//                            "<img style='width:663px;height:400px' class='fo' id='businessPic2' src='/Uploader?action=stream&folder=" + uid + "&filename=businessPic2.jpg'>" +
//                        "</li>" +
//                    "</ul>" +
//                "</div>";
                //$('#busSlides').append(slider);

                //web & social
                console.log(item.fb);
                if (item.ws !== null && item.ws !== '')
                    $('#lnkWs').attr('href', item.ws);
                else
                    $('#lnkWs').hide();
                if (item.fb !== null && item.fb !== '')
                    $('#lnkFb').attr('href', item.fb);
                else
                    $('#lnkFb').hide();
                if (item.tw !== null && item.tw !== '')
                    $('#lnkTw').attr('href', item.tw);
                else
                    $('#lnkTw').hide();
                if (item.gp !== null && item.gp !== '')
                    $('#lnkGp').attr('href', item.gp);
                else
                    $('#lnkGp').hide();
                if (item.lk !== null && item.lk !== '')
                    $('#lnkLk').attr('href', item.lk);
                else
                    $('#lnkLk').hide();

                //causing errors in chrome something cast_sender.js
                $('#businessVideo').attr("src", "//www.youtube.com/embed/zpOULjyy-n8?rel=0");// "/Uploader?action=stream&folder=" + uid + "&filename=financials.pdf");

                //console.log($('#businessLogo').css('height'));
            });
            
            //Invest button functionality
            $('#ivstComp').click(function(){
               if(!isUsrLoggedIn){
                   fgAlert('You need to be logged in to perform this action!');
               }else{
                   window.location='invest.html' + '#' + busIdd;
               }                   
            });
            

//            uid = 143;
//            lid = 39;
//            bid = 22;
//            var user, loc, business;
//
//            $.getJSON("/rs/user/" + uid, function (data) {
//                user = data;
//                //alert(user.firstName);
//                console.log(user);
//            });
//            $.getJSON("/rs/location/" + lid, function (data) {
//                loc = data;
//                //alert(location.address);
//                console.log(loc);
//                $('#address').html(loc.address + ', ' + loc.city + ', ' + loc.state + ', ' + loc.zip);
//                $('#address1').html(loc.address + ', ' + loc.city + ', ' + loc.state + ', ' + loc.zip);
//            });
//            $.getJSON("/rs/business/" + bid, function (data) {
//                business = data;
//                //alert(business.businessName);
//                console.log(business);
//                $('#businessName').html(business.businessName);
//                $('#businessName1').html(business.businessName);
//                $('#summary').html(business.summary.replace(/(?:\r\n|\r|\n)/g, '<br />'));
//                $('#summary1').html(business.summary.replace(/(?:\r\n|\r|\n)/g, '<br />'));
//                $('#description').html(business.description.replace(/(?:\r\n|\r|\n)/g, '<br />'));
//                $('#targetAmount').autoNumeric('init', {aSign: '$'});
//                $('#targetAmount').autoNumeric('set', business.targetAmount);
//                //$('#targetAmount').html(business.targetAmount);
//            });
//
//            //set all images
//            $('#businessLogo').attr("src", "/Uploader?action=stream&folder=" + uid + "&filename=businessLogo.jpg");
//            $('#businessLogo1').attr("src", "/Uploader?action=stream&folder=" + uid + "&filename=businessLogo.jpg");
//            $('#businessPic1').attr("src", "/Uploader?action=stream&folder=" + uid + "&filename=businessPic1.jpg");
//            $('#businessPic2').attr("src", "/Uploader?action=stream&folder=" + uid + "&filename=businessPic2.jpg");
//            $('#execSumm').attr("href", "/Uploader?action=stream&folder=" + uid + "&filename=execSumm.pdf");
//            $('#businessPlan').attr("href", "/Uploader?action=stream&folder=" + uid + "&filename=businessPlan.pdf");
//            $('#financials').attr("href", "/Uploader?action=stream&folder=" + uid + "&filename=financials.pdf");
//
//            //causing errors in chrome something cast_sender.js
//            $('#businessVideo').attr("src", "//www.youtube.com/embed/zpOULjyy-n8?rel=0");// "/Uploader?action=stream&folder=" + uid + "&filename=financials.pdf");


        </script>
    </body>
</html>
